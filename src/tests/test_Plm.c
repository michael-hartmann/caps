#include <math.h>
#include "unittest.h"
#include "sfunc.h"
#include "libcasimir.h"

#include "test_Plm.h"

int test_Plm()
{
    unittest_t test;

    unittest_init(&test, "Plm", "Test associated Legendre polynomials");

    AssertAlmostEqual(&test, Plm(1,0,1.01), 0.00995033085316809);
    AssertAlmostEqual(&test, Plm(1,0,1.1), 0.09531017980432493);
    AssertAlmostEqual(&test, Plm(1,0,1.5), 0.40546510810816433);
    AssertAlmostEqual(&test, Plm(1,0,2), 0.6931471805599453);
    AssertAlmostEqual(&test, Plm(1,0,5), 1.6094379124341003);
    AssertAlmostEqual(&test, Plm(1,0,10), 2.3025850929940455);
    AssertAlmostEqual(&test, Plm(1,0,50), 3.912023005428146);
    AssertAlmostEqual(&test, Plm(1,0,100), 4.605170185988091);
    AssertAlmostEqual(&test, Plm(1,0,500), 6.214608098422191);
    AssertAlmostEqual(&test, Plm(1,0,1000), 6.907755278982137);
    AssertAlmostEqual(&test, Plm(1,0,1e+06), 13.815510557964274);
    AssertAlmostEqual(&test, Plm(1,1,1.01), -1.953517731958553);
    AssertAlmostEqual(&test, Plm(1,1,1.1), -0.7803238741323337);
    AssertAlmostEqual(&test, Plm(1,1,1.5), 0.11157177565710487);
    AssertAlmostEqual(&test, Plm(1,1,2), 0.5493061443340548);
    AssertAlmostEqual(&test, Plm(1,1,5), 1.5890269151739727);
    AssertAlmostEqual(&test, Plm(1,1,10), 2.297559925067295);
    AssertAlmostEqual(&test, Plm(1,1,50), 3.911822965417476);
    AssertAlmostEqual(&test, Plm(1,1,100), 4.605120183487924);
    AssertAlmostEqual(&test, Plm(1,1,500), 6.214606098418192);
    AssertAlmostEqual(&test, Plm(1,1,1000), 6.907754778981887);
    AssertAlmostEqual(&test, Plm(1,1,1e+06), 13.815510557963773);

    AssertAlmostEqual(&test, Plm(5,0,1.01), 0.1443777033740475);
    AssertAlmostEqual(&test, Plm(5,0,1.1), 1.1310847224188405);
    AssertAlmostEqual(&test, Plm(5,0,1.5), 3.4989902724420365);
    AssertAlmostEqual(&test, Plm(5,0,2), 5.224401683597868);
    AssertAlmostEqual(&test, Plm(5,0,5), 10.06581896445358);
    AssertAlmostEqual(&test, Plm(5,0,10), 13.5654694258405);
    AssertAlmostEqual(&test, Plm(5,0,50), 21.623363706725453);
    AssertAlmostEqual(&test, Plm(5,0,100), 25.08943299974896);
    AssertAlmostEqual(&test, Plm(5,0,500), 33.13672923237214);
    AssertAlmostEqual(&test, Plm(5,0,1000), 36.602468468510885);
    AssertAlmostEqual(&test, Plm(5,0,1e+06), 71.14124597453196);
    AssertAlmostEqual(&test, Plm(5,1,1.01), 0.8235084983221109);
    AssertAlmostEqual(&test, Plm(5,1,1.1), 2.54332404330678);
    AssertAlmostEqual(&test, Plm(5,1,1.5), 5.068443621783747);
    AssertAlmostEqual(&test, Plm(5,1,2), 6.816269473090174);
    AssertAlmostEqual(&test, Plm(5,1,5), 11.672959264491194);
    AssertAlmostEqual(&test, Plm(5,1,10), 15.17434719989084);
    AssertAlmostEqual(&test, Plm(5,1,50), 23.23277938966839);
    AssertAlmostEqual(&test, Plm(5,1,100), 26.69886535617332);
    AssertAlmostEqual(&test, Plm(5,1,500), 34.74616692258329);
    AssertAlmostEqual(&test, Plm(5,1,1000), 38.211906325389386);
    AssertAlmostEqual(&test, Plm(5,1,1e+06), 72.75068388696599);
    AssertAlmostEqual(&test, Plm(5,5,1.01), -2.9164037322990226);
    AssertAlmostEqual(&test, Plm(5,5,1.1), 2.949565556832074);
    AssertAlmostEqual(&test, Plm(5,5,1.5), 7.409043805779267);
    AssertAlmostEqual(&test, Plm(5,5,2), 9.597715649164016);
    AssertAlmostEqual(&test, Plm(5,5,5), 14.796319503363605);
    AssertAlmostEqual(&test, Plm(5,5,10), 18.338984552830215);
    AssertAlmostEqual(&test, Plm(5,5,50), 26.41029975458112);
    AssertAlmostEqual(&test, Plm(5,5,100), 29.876785844933366);
    AssertAlmostEqual(&test, Plm(5,5,500), 37.9242154195847);
    AssertAlmostEqual(&test, Plm(5,5,1000), 41.38995882240317);
    AssertAlmostEqual(&test, Plm(5,5,1e+06), 75.9287377173126);

    AssertAlmostEqual(&test, Plm(10,0,1.01), 0.4877660471778842);
    AssertAlmostEqual(&test, Plm(10,0,1.1), 2.9853524385054198);
    AssertAlmostEqual(&test, Plm(10,0,1.5), 7.97152817236183);
    AssertAlmostEqual(&test, Plm(10,0,2), 11.47273368360779);
    AssertAlmostEqual(&test, Plm(10,0,5), 21.193564845688325);
    AssertAlmostEqual(&test, Plm(10,0,10), 28.19740034187603);
    AssertAlmostEqual(&test, Plm(10,0,50), 44.314602058154854);
    AssertAlmostEqual(&test, Plm(10,0,100), 51.24678451823574);
    AssertAlmostEqual(&test, Plm(10,0,500), 67.34139101952704);
    AssertAlmostEqual(&test, Plm(10,0,1000), 74.27286993040246);
    AssertAlmostEqual(&test, Plm(10,0,1e+06), 143.35042508864336);
    AssertAlmostEqual(&test, Plm(10,1,1.01), 2.3118451738812786);
    AssertAlmostEqual(&test, Plm(10,1,1.1), 5.206849812025071);
    AssertAlmostEqual(&test, Plm(10,1,1.5), 10.255764920165175);
    AssertAlmostEqual(&test, Plm(10,1,2), 13.767103131424927);
    AssertAlmostEqual(&test, Plm(10,1,5), 23.495063352349288);
    AssertAlmostEqual(&test, Plm(10,1,10), 30.499720210145995);
    AssertAlmostEqual(&test, Plm(10,1,50), 46.61717662155351);
    AssertAlmostEqual(&test, Plm(10,1,100), 53.54936697944592);
    AssertAlmostEqual(&test, Plm(10,1,500), 69.64397600725759);
    AssertAlmostEqual(&test, Plm(10,1,1000), 76.5754549970807);
    AssertAlmostEqual(&test, Plm(10,1,1e+06), 145.65301018163737);
    AssertAlmostEqual(&test, Plm(10,5,1.01), 5.157035703216551);
    AssertAlmostEqual(&test, Plm(10,5,1.1), 11.570910101939365);
    AssertAlmostEqual(&test, Plm(10,5,1.5), 17.842861655986507);
    AssertAlmostEqual(&test, Plm(10,5,2), 21.586765038605602);
    AssertAlmostEqual(&test, Plm(10,5,5), 31.483362977337464);
    AssertAlmostEqual(&test, Plm(10,5,10), 38.50769304102551);
    AssertAlmostEqual(&test, Plm(10,5,50), 54.63125965247692);
    AssertAlmostEqual(&test, Plm(10,5,100), 61.56363955417693);
    AssertAlmostEqual(&test, Plm(10,5,500), 77.65830921823375);
    AssertAlmostEqual(&test, Plm(10,5,1000), 84.5897901028007);
    AssertAlmostEqual(&test, Plm(10,5,1e+06), 153.66734591893618);
    AssertAlmostEqual(&test, Plm(10,10,1.01), 0.7645547624929862);
    AssertAlmostEqual(&test, Plm(10,10,1.1), 12.496493340755178);
    AssertAlmostEqual(&test, Plm(10,10,1.5), 21.415449838649565);
    AssertAlmostEqual(&test, Plm(10,10,2), 25.792793525419064);
    AssertAlmostEqual(&test, Plm(10,10,5), 36.19000123381824);
    AssertAlmostEqual(&test, Plm(10,10,10), 43.27533133275146);
    AssertAlmostEqual(&test, Plm(10,10,50), 59.417961736253275);
    AssertAlmostEqual(&test, Plm(10,10,100), 66.35093391695776);
    AssertAlmostEqual(&test, Plm(10,10,500), 82.44579306626042);
    AssertAlmostEqual(&test, Plm(10,10,1000), 89.37727987189739);
    AssertAlmostEqual(&test, Plm(10,10,1e+06), 158.45483766171625);

    AssertAlmostEqual(&test, Plm(50,0,1.01), 5.251764379275801);
    AssertAlmostEqual(&test, Plm(50,0,1.1), 19.916497983164188);
    AssertAlmostEqual(&test, Plm(50,0,1.5), 45.670024247602);
    AssertAlmostEqual(&test, Plm(50,0,2), 63.3546620129539);
    AssertAlmostEqual(&test, Plm(50,0,5), 112.09588794463903);
    AssertAlmostEqual(&test, Plm(50,0,10), 147.13153649500967);
    AssertAlmostEqual(&test, Plm(50,0,50), 227.72268266296751);
    AssertAlmostEqual(&test, Plm(50,0,100), 262.3837545036006);
    AssertAlmostEqual(&test, Plm(50,0,500), 342.8568380501065);
    AssertAlmostEqual(&test, Plm(50,0,1000), 377.514234199385);
    AssertAlmostEqual(&test, Plm(50,0,1e+06), 722.9020105222214);
    AssertAlmostEqual(&test, Plm(50,1,1.01), 9.097471733569119);
    AssertAlmostEqual(&test, Plm(50,1,1.1), 23.81416668339634);
    AssertAlmostEqual(&test, Plm(50,1,1.5), 49.57858416294979);
    AssertAlmostEqual(&test, Plm(50,1,2), 67.26511989971114);
    AssertAlmostEqual(&test, Plm(50,1,5), 116.00770261583082);
    AssertAlmostEqual(&test, Plm(50,1,10), 151.0435086107852);
    AssertAlmostEqual(&test, Plm(50,1,50), 231.63470364758325);
    AssertAlmostEqual(&test, Plm(50,1,100), 266.2957770039401);
    AssertAlmostEqual(&test, Plm(50,1,500), 346.7688610353326);
    AssertAlmostEqual(&test, Plm(50,1,1000), 381.42625719976263);
    AssertAlmostEqual(&test, Plm(50,1,1e+06), 726.8140335276496);
    AssertAlmostEqual(&test, Plm(50,5,1.01), 23.038247141365222);
    AssertAlmostEqual(&test, Plm(50,5,1.1), 38.91341611149594);
    AssertAlmostEqual(&test, Plm(50,5,1.5), 64.9373637461748);
    AssertAlmostEqual(&test, Plm(50,5,2), 82.66938336265711);
    AssertAlmostEqual(&test, Plm(50,5,5), 131.44451317185312);
    AssertAlmostEqual(&test, Plm(50,5,10), 166.4840975823886);
    AssertAlmostEqual(&test, Plm(50,5,50), 247.07646545532785);
    AssertAlmostEqual(&test, Plm(50,5,100), 281.7375751890318);
    AssertAlmostEqual(&test, Plm(50,5,500), 362.2106708577003);
    AssertAlmostEqual(&test, Plm(50,5,1000), 396.8680673857681);
    AssertAlmostEqual(&test, Plm(50,5,1e+06), 742.2558438348672);
    AssertAlmostEqual(&test, Plm(50,10,1.01), 37.7949347531984);
    AssertAlmostEqual(&test, Plm(50,10,1.1), 56.6687112091108);
    AssertAlmostEqual(&test, Plm(50,10,1.5), 83.48220767293111);
    AssertAlmostEqual(&test, Plm(50,10,2), 101.35554051734911);
    AssertAlmostEqual(&test, Plm(50,10,5), 150.23218621891817);
    AssertAlmostEqual(&test, Plm(50,10,10), 185.28357503153336);
    AssertAlmostEqual(&test, Plm(50,10,50), 265.879607819157);
    AssertAlmostEqual(&test, Plm(50,10,100), 300.54083123177764);
    AssertAlmostEqual(&test, Plm(50,10,500), 381.01396326691406);
    AssertAlmostEqual(&test, Plm(50,10,1000), 415.67136093134974);
    AssertAlmostEqual(&test, Plm(50,10,1e+06), 761.0591377592366);
    AssertAlmostEqual(&test, Plm(50,50,1.01), 82.92836297786553);
    AssertAlmostEqual(&test, Plm(50,50,1.1), 141.5880558691765);
    AssertAlmostEqual(&test, Plm(50,50,1.5), 186.1828383586484);
    AssertAlmostEqual(&test, Plm(50,50,2), 208.06955679249592);
    AssertAlmostEqual(&test, Plm(50,50,5), 260.0555953344918);
    AssertAlmostEqual(&test, Plm(50,50,10), 295.48224582915793);
    AssertAlmostEqual(&test, Plm(50,50,50), 376.195397846667);
    AssertAlmostEqual(&test, Plm(50,50,100), 410.8602587501894);
    AssertAlmostEqual(&test, Plm(50,50,500), 491.33455449670276);
    AssertAlmostEqual(&test, Plm(50,50,1000), 525.9919885248875);
    AssertAlmostEqual(&test, Plm(50,50,1e+06), 871.3797774739818);

    AssertAlmostEqual(&test, Plm(100,0,1.01), 11.962964483458157);
    AssertAlmostEqual(&test, Plm(100,0,1.1), 41.74776988801881);
    AssertAlmostEqual(&test, Plm(100,0,1.5), 93.44544727312349);
    AssertAlmostEqual(&test, Plm(100,0,2), 128.85703644825924);
    AssertAlmostEqual(&test, Plm(100,0,5), 226.37212162047132);
    AssertAlmostEqual(&test, Plm(100,0,10), 296.44734878125274);
    AssertAlmostEqual(&test, Plm(100,0,50), 457.6308673316007);
    AssertAlmostEqual(&test, Plm(100,0,100), 526.9530490939379);
    AssertAlmostEqual(&test, Plm(100,0,500), 687.8992283698669);
    AssertAlmostEqual(&test, Plm(100,0,1000), 757.2140210491165);
    AssertAlmostEqual(&test, Plm(100,0,1e+06), 1447.9895738216865);
    AssertAlmostEqual(&test, Plm(100,1,1.01), 16.536346424244417);
    AssertAlmostEqual(&test, Plm(100,1,1.1), 46.3458523370313);
    AssertAlmostEqual(&test, Plm(100,1,1.5), 98.04889769188037);
    AssertAlmostEqual(&test, Plm(100,1,2), 133.46142863478607);
    AssertAlmostEqual(&test, Plm(100,1,5), 230.97718817389858);
    AssertAlmostEqual(&test, Plm(100,1,10), 301.0524936509405);
    AssertAlmostEqual(&test, Plm(100,1,50), 462.2360365122611);
    AssertAlmostEqual(&test, Plm(100,1,100), 531.5582190286508);
    AssertAlmostEqual(&test, Plm(100,1,500), 692.5043985458047);
    AssertAlmostEqual(&test, Plm(100,1,1000), 761.819191232592);
    AssertAlmostEqual(&test, Plm(100,1,1e+06), 1452.5947440076745);
    AssertAlmostEqual(&test, Plm(100,5,1.01), 34.10277570044912);
    AssertAlmostEqual(&test, Plm(100,5,1.1), 64.49512261401553);
    AssertAlmostEqual(&test, Plm(100,5,1.5), 116.32677986471273);
    AssertAlmostEqual(&test, Plm(100,5,2), 151.76190508973625);
    AssertAlmostEqual(&test, Plm(100,5,5), 249.29384752416067);
    AssertAlmostEqual(&test, Plm(100,5,10), 319.3710325604637);
    AssertAlmostEqual(&test, Plm(100,5,50), 480.5551588831745);
    AssertAlmostEqual(&test, Plm(100,5,100), 549.8773594968228);
    AssertAlmostEqual(&test, Plm(100,5,500), 710.8235448033744);
    AssertAlmostEqual(&test, Plm(100,5,1000), 780.1383376710668);
    AssertAlmostEqual(&test, Plm(100,5,1e+06), 1470.9138905064508);
    AssertAlmostEqual(&test, Plm(100,10,1.01), 54.519973885942846);
    AssertAlmostEqual(&test, Plm(100,10,1.1), 86.62947342742189);
    AssertAlmostEqual(&test, Plm(100,10,1.5), 138.860372593018);
    AssertAlmostEqual(&test, Plm(100,10,2), 174.36600447369366);
    AssertAlmostEqual(&test, Plm(100,10,5), 271.94849484328086);
    AssertAlmostEqual(&test, Plm(100,10,10), 342.03155311883495);
    AssertAlmostEqual(&test, Plm(100,10,50), 503.2175027342305);
    AssertAlmostEqual(&test, Plm(100,10,100), 572.5397599017762);
    AssertAlmostEqual(&test, Plm(100,10,500), 733.4859633001929);
    AssertAlmostEqual(&test, Plm(100,10,1000), 802.8007567332141);
    AssertAlmostEqual(&test, Plm(100,10,1e+06), 1493.5763097570402);
    AssertAlmostEqual(&test, Plm(100,50,1.01), 176.46282417603015);
    AssertAlmostEqual(&test, Plm(100,50,1.1), 241.06115080063847);
    AssertAlmostEqual(&test, Plm(100,50,1.5), 304.506229737986);
    AssertAlmostEqual(&test, Plm(100,50,2), 342.19333262236023);
    AssertAlmostEqual(&test, Plm(100,50,5), 441.3749906552409);
    AssertAlmostEqual(&test, Plm(100,50,10), 511.6456869778622);
    AssertAlmostEqual(&test, Plm(100,50,50), 672.889962648064);
    AssertAlmostEqual(&test, Plm(100,50,100), 742.2140295117537);
    AssertAlmostEqual(&test, Plm(100,50,500), 903.1608118479568);
    AssertAlmostEqual(&test, Plm(100,50,1000), 972.4756233714953);
    AssertAlmostEqual(&test, Plm(100,50,1e+06), 1663.2511824254705);
    AssertAlmostEqual(&test, Plm(100,100,1.01), 234.82612038499210316);
    AssertAlmostEqual(&test, Plm(100,100,1.1), 352.14550616761403);
    AssertAlmostEqual(&test, Plm(100,100,1.5), 441.33507114655794);
    AssertAlmostEqual(&test, Plm(100,100,2), 485.1085080142529);
    AssertAlmostEqual(&test, Plm(100,100,5), 589.0805850982447);
    AssertAlmostEqual(&test, Plm(100,100,10), 659.9338860875769);
    AssertAlmostEqual(&test, Plm(100,100,50), 821.360190122595);
    AssertAlmostEqual(&test, Plm(100,100,100), 890.6899119296398);
    AssertAlmostEqual(&test, Plm(100,100,500), 1051.6385034226664);
    AssertAlmostEqual(&test, Plm(100,100,1000), 1120.9533714790362);
    AssertAlmostEqual(&test, Plm(100,100,1e+06), 1811.7289493772248);

    AssertAlmostEqual(&test, Plm(500,0,1.01), 67.67434498032577);
    AssertAlmostEqual(&test, Plm(500,0,1.1), 218.369931617909);
    AssertAlmostEqual(&test, Plm(500,0,1.5), 477.6108439394777);
    AssertAlmostEqual(&test, Plm(500,0,2), 654.8363204761886);
    AssertAlmostEqual(&test, Plm(500,0,5), 1142.5410497358569);
    AssertAlmostEqual(&test, Plm(500,0,10), 1492.9327632020668);
    AssertAlmostEqual(&test, Plm(500,0,50), 2298.855216562853);
    AssertAlmostEqual(&test, Plm(500,0,100), 2645.4662763264428);
    AssertAlmostEqual(&test, Plm(500,0,500), 3450.1972209987257);
    AssertAlmostEqual(&test, Plm(500,0,1000), 3796.771185904025);
    AssertAlmostEqual(&test, Plm(500,0,1e+06), 7250.6489502698905);
    AssertAlmostEqual(&test, Plm(500,1,1.01), 73.88278489127198);
    AssertAlmostEqual(&test, Plm(500,1,1.1), 224.58313594464965);
    AssertAlmostEqual(&test, Plm(500,1,1.5), 483.8251099379287);
    AssertAlmostEqual(&test, Plm(500,1,2), 661.0507736951938);
    AssertAlmostEqual(&test, Plm(500,1,5), 1148.7556371924848);
    AssertAlmostEqual(&test, Plm(500,1,10), 1499.1473662576052);
    AssertAlmostEqual(&test, Plm(500,1,50), 2305.069824461015);
    AssertAlmostEqual(&test, Plm(500,1,100), 2651.6808843748113);
    AssertAlmostEqual(&test, Plm(500,1,500), 3456.411829095146);
    AssertAlmostEqual(&test, Plm(500,1,1000), 3802.985794001947);
    AssertAlmostEqual(&test, Plm(500,1,1e+06), 7256.863558368313);
    AssertAlmostEqual(&test, Plm(500,5,1.01), 98.57319171601753);
    AssertAlmostEqual(&test, Plm(500,5,1.1), 249.38781929785907);
    AssertAlmostEqual(&test, Plm(500,5,1.5), 508.65527174275894);
    AssertAlmostEqual(&test, Plm(500,5,2), 685.8854287299744);
    AssertAlmostEqual(&test, Plm(500,5,5), 1173.5935139152787);
    AssertAlmostEqual(&test, Plm(500,5,10), 1523.9856173540122);
    AssertAlmostEqual(&test, Plm(500,5,50), 2329.908191780365);
    AssertAlmostEqual(&test, Plm(500,5,100), 2676.5192552991175);
    AssertAlmostEqual(&test, Plm(500,5,500), 3481.2502011726956);
    AssertAlmostEqual(&test, Plm(500,5,1000), 3827.8241661155325);
    AssertAlmostEqual(&test, Plm(500,5,1e+06), 7281.70193049391);
    AssertAlmostEqual(&test, Plm(500,10,1.01), 129.1142009984162);
    AssertAlmostEqual(&test, Plm(500,10,1.1), 280.2850888002344);
    AssertAlmostEqual(&test, Plm(500,10,1.5), 539.6321407602924);
    AssertAlmostEqual(&test, Plm(500,10,2), 716.876338307201);
    AssertAlmostEqual(&test, Plm(500,10,5), 1204.5944910827982);
    AssertAlmostEqual(&test, Plm(500,10,10), 1554.987764436067);
    AssertAlmostEqual(&test, Plm(500,10,50), 2360.910702058927);
    AssertAlmostEqual(&test, Plm(500,10,100), 2707.521776843168);
    AssertAlmostEqual(&test, Plm(500,10,500), 3512.252726320631);
    AssertAlmostEqual(&test, Plm(500,10,1000), 3858.8266913760813);
    AssertAlmostEqual(&test, Plm(500,10,1e+06), 7312.704455791996);
    AssertAlmostEqual(&test, Plm(500,50,1.01), 361.09574328136074);
    AssertAlmostEqual(&test, Plm(500,50,1.1), 523.073734528164);
    AssertAlmostEqual(&test, Plm(500,50,1.5), 784.9517084101057);
    AssertAlmostEqual(&test, Plm(500,50,2), 962.6445786135785);
    AssertAlmostEqual(&test, Plm(500,50,5), 1450.6847466448119);
    AssertAlmostEqual(&test, Plm(500,50,10), 1801.1154548591724);
    AssertAlmostEqual(&test, Plm(500,50,50), 2607.0500146187533);
    AssertAlmostEqual(&test, Plm(500,50,100), 2953.6614498983918);
    AssertAlmostEqual(&test, Plm(500,50,500), 3758.392514700156);
    AssertAlmostEqual(&test, Plm(500,50,1000), 4104.966483359222);
    AssertAlmostEqual(&test, Plm(500,50,1e+06), 7558.844248976339);
    AssertAlmostEqual(&test, Plm(500,100,1.01), 624.6143487604087);
    AssertAlmostEqual(&test, Plm(500,100,1.1), 815.4370579952206);
    AssertAlmostEqual(&test, Plm(500,100,1.5), 1085.0325584587522);
    AssertAlmostEqual(&test, Plm(500,100,2), 1264.1198067814141);
    AssertAlmostEqual(&test, Plm(500,100,5), 1753.1644352752814);
    AssertAlmostEqual(&test, Plm(500,100,10), 2103.7120973975634);
    AssertAlmostEqual(&test, Plm(500,100,50), 2909.6829744405854);
    AssertAlmostEqual(&test, Plm(500,100,100), 3256.2955362655425);
    AssertAlmostEqual(&test, Plm(500,100,500), 4061.026961455561);
    AssertAlmostEqual(&test, Plm(500,100,1000), 4407.600941375931);
    AssertAlmostEqual(&test, Plm(500,100,1e+06), 7861.4787107468);
    AssertAlmostEqual(&test, Plm(500,500,1.01), 1977.4652637687578635);
    AssertAlmostEqual(&test, Plm(500,500,1.1), 2564.0621926818675169);
    AssertAlmostEqual(&test, Plm(500,500,1.5), 3010.010017576587);
    AssertAlmostEqual(&test, Plm(500,500,2), 3228.877201915062);
    AssertAlmostEqual(&test, Plm(500,500,5), 3748.7375873350206);
    AssertAlmostEqual(&test, Plm(500,500,10), 4103.004092281682);
    AssertAlmostEqual(&test, Plm(500,500,50), 4910.135612456772);
    AssertAlmostEqual(&test, Plm(500,500,100), 5256.7842214919965);
    AssertAlmostEqual(&test, Plm(500,500,500), 6061.52717895713);
    AssertAlmostEqual(&test, Plm(500,500,1000), 6408.101519238978);
    AssertAlmostEqual(&test, Plm(500,500,1e+06), 9861.979408729921);

    AssertAlmostEqual(&test, Plm(1000,0,1.01), 137.97900730957372);
    AssertAlmostEqual(&test, Plm(1000,0,1.1), 439.8074345368616);
    AssertAlmostEqual(&test, Plm(1000,0,1.5), 958.4761776175219);
    AssertAlmostEqual(&test, Plm(1000,0,2), 1312.9688009771617);
    AssertAlmostEqual(&test, Plm(1000,0,5), 2288.4104333445875);
    AssertAlmostEqual(&test, Plm(1000,0,10), 2989.1977370442632);
    AssertAlmostEqual(&test, Plm(1000,0,50), 4601.04385343987);
    AssertAlmostEqual(&test, Plm(1000,0,100), 5294.266010535109);
    AssertAlmostEqual(&test, Plm(1000,0,500), 6903.727911898477);
    AssertAlmostEqual(&test, Plm(1000,0,1000), 7596.87584208464);
    AssertAlmostEqual(&test, Plm(1000,0,1e+06), 14504.631370941557);
    AssertAlmostEqual(&test, Plm(1000,1,1.01), 144.88368961589504);
    AssertAlmostEqual(&test, Plm(1000,1,1.1), 446.71448877540297);
    AssertAlmostEqual(&test, Plm(1000,1,1.5), 965.383761961418);
    AssertAlmostEqual(&test, Plm(1000,1,2), 1319.8764788611857);
    AssertAlmostEqual(&test, Plm(1000,1,5), 2295.318178307942);
    AssertAlmostEqual(&test, Plm(1000,1,10), 2996.105489803071);
    AssertAlmostEqual(&test, Plm(1000,1,50), 4607.951608618772);
    AssertAlmostEqual(&test, Plm(1000,1,100), 5301.173765789076);
    AssertAlmostEqual(&test, Plm(1000,1,500), 6910.635667176459);
    AssertAlmostEqual(&test, Plm(1000,1,1000), 7603.783597363372);
    AssertAlmostEqual(&test, Plm(1000,1,1e+06), 14511.53912622054);
    AssertAlmostEqual(&test, Plm(1000,5,1.01), 172.43095308184598);
    AssertAlmostEqual(&test, Plm(1000,5,1.1), 474.31867010444955);
    AssertAlmostEqual(&test, Plm(1000,5,1.5), 993.0006656116423);
    AssertAlmostEqual(&test, Plm(1000,5,2), 1347.4956274665913);
    AssertAlmostEqual(&test, Plm(1000,5,5), 2322.9389368154248);
    AssertAlmostEqual(&test, Plm(1000,5,10), 3023.726435401402);
    AssertAlmostEqual(&test, Plm(1000,5,50), 4635.5726122993565);
    AssertAlmostEqual(&test, Plm(1000,5,100), 5328.794771271238);
    AssertAlmostEqual(&test, Plm(1000,5,500), 6938.256673234953);
    AssertAlmostEqual(&test, Plm(1000,5,1000), 7631.404603439875);
    AssertAlmostEqual(&test, Plm(1000,5,1e+06), 14539.160132303046);
    AssertAlmostEqual(&test, Plm(1000,10,1.01), 206.7042634885491);
    AssertAlmostEqual(&test, Plm(1000,10,1.1), 508.76974368580466);
    AssertAlmostEqual(&test, Plm(1000,10,1.5), 1027.4914938813115);
    AssertAlmostEqual(&test, Plm(1000,10,2), 1381.993471123552);
    AssertAlmostEqual(&test, Plm(1000,10,5), 2357.4418113933493);
    AssertAlmostEqual(&test, Plm(1000,10,10), 3058.2298946378514);
    AssertAlmostEqual(&test, Plm(1000,10,50), 4670.076253042827);
    AssertAlmostEqual(&test, Plm(1000,10,100), 5363.298417644634);
    AssertAlmostEqual(&test, Plm(1000,10,500), 6972.760321409391);
    AssertAlmostEqual(&test, Plm(1000,10,1000), 7665.908251670591);
    AssertAlmostEqual(&test, Plm(1000,10,1e+06), 14573.663780552522);
    AssertAlmostEqual(&test, Plm(1000,50,1.01), 474.5261973388883);
    AssertAlmostEqual(&test, Plm(1000,50,1.1), 782.1991216934603);
    AssertAlmostEqual(&test, Plm(1000,50,1.5), 1302.190977592703);
    AssertAlmostEqual(&test, Plm(1000,50,2), 1656.9173691658418);
    AssertAlmostEqual(&test, Plm(1000,50,5), 2632.526680489959);
    AssertAlmostEqual(&test, Plm(1000,50,10), 3333.3334725075015);
    AssertAlmostEqual(&test, Plm(1000,50,50), 4945.18563911826);
    AssertAlmostEqual(&test, Plm(1000,50,100), 5638.407983877662);
    AssertAlmostEqual(&test, Plm(1000,50,500), 7247.869945275728);
    AssertAlmostEqual(&test, Plm(1000,50,1000), 7941.017877337837);
    AssertAlmostEqual(&test, Plm(1000,50,1e+06), 14848.773406820066);
    AssertAlmostEqual(&test, Plm(1000,100,1.01), 794.1727225453953);
    AssertAlmostEqual(&test, Plm(1000,100,1.1), 1118.4853446625614);
    AssertAlmostEqual(&test, Plm(1000,100,1.5), 1642.4211160414438);
    AssertAlmostEqual(&test, Plm(1000,100,2), 1997.8478295053453);
    AssertAlmostEqual(&test, Plm(1000,100,5), 2973.9599454242243);
    AssertAlmostEqual(&test, Plm(1000,100,10), 3674.8251986109312);
    AssertAlmostEqual(&test, Plm(1000,100,50), 5286.6955156285985);
    AssertAlmostEqual(&test, Plm(1000,100,100), 5979.918423380138);
    AssertAlmostEqual(&test, Plm(1000,100,500), 7589.380564882273);
    AssertAlmostEqual(&test, Plm(1000,100,1000), 8282.528502572215);
    AssertAlmostEqual(&test, Plm(1000,100,1e+06), 15190.284033930384);
    AssertAlmostEqual(&test, Plm(1000,500,1.01), 2935.8117894480582032);
    AssertAlmostEqual(&test, Plm(1000,500,1.1), 3582.309249564578);
    AssertAlmostEqual(&test, Plm(1000,500,1.5), 4217.498255925017);
    AssertAlmostEqual(&test, Plm(1000,500,2), 4594.6097374355295);
    AssertAlmostEqual(&test, Plm(1000,500,5), 5586.632588306393);
    AssertAlmostEqual(&test, Plm(1000,500,10), 6289.365612497314);
    AssertAlmostEqual(&test, Plm(1000,500,50), 7901.816553766344);
    AssertAlmostEqual(&test, Plm(1000,500,100), 8595.057476986954);
    AssertAlmostEqual(&test, Plm(1000,500,500), 10204.525381800702);
    AssertAlmostEqual(&test, Plm(1000,500,1000), 10897.673499581337);
    AssertAlmostEqual(&test, Plm(1000,500,1e+06), 17805.4290909695);
    AssertAlmostEqual(&test, Plm(1000,1000,1.01), 4647.7312595071446055);
    AssertAlmostEqual(&test, Plm(1000,1000,1.1), 5820.9251173333639122);
    AssertAlmostEqual(&test, Plm(1000,1000,1.5), 6712.820767122803);
    AssertAlmostEqual(&test, Plm(1000,1000,2), 7150.555135799753);
    AssertAlmostEqual(&test, Plm(1000,1000,5), 8190.27590663967);
    AssertAlmostEqual(&test, Plm(1000,1000,10), 8898.808916532993);
    AssertAlmostEqual(&test, Plm(1000,1000,50), 10513.071956883174);
    AssertAlmostEqual(&test, Plm(1000,1000,100), 11206.369174953621);
    AssertAlmostEqual(&test, Plm(1000,1000,500), 12815.85508988389);
    AssertAlmostEqual(&test, Plm(1000,1000,1000), 13509.003770447584);
    AssertAlmostEqual(&test, Plm(1000,1000,1e+06), 20416.75954942947);

    AssertAlmostEqual(&test, Plm(2000,0,1.01), 278.93588089266973);
    AssertAlmostEqual(&test, Plm(2000,0,1.1), 883.0290901488979);
    AssertAlmostEqual(&test, Plm(2000,0,1.5), 1920.5532952723843);
    AssertAlmostEqual(&test, Plm(2000,0,2), 2629.5801771345295);
    AssertAlmostEqual(&test, Plm(2000,0,5), 4580.4955905256975);
    AssertAlmostEqual(&test, Plm(2000,0,10), 5982.074071765259);
    AssertAlmostEqual(&test, Plm(2000,0,50), 9205.767513321829);
    AssertAlmostEqual(&test, Plm(2000,0,100), 10592.21186505218);
    AssertAlmostEqual(&test, Plm(2000,0,500), 13811.135679788704);
    AssertAlmostEqual(&test, Plm(2000,0,1000), 15197.431540536312);
    AssertAlmostEqual(&test, Plm(2000,0,1e+06), 29012.94259837524);
    AssertAlmostEqual(&test, Plm(2000,1,1.01), 286.5352496190604);
    AssertAlmostEqual(&test, Plm(2000,1,1.1), 890.6296422989395);
    AssertAlmostEqual(&test, Plm(2000,1,1.5), 1928.1541122930694);
    AssertAlmostEqual(&test, Plm(2000,1,2), 2637.1810409077684);
    AssertAlmostEqual(&test, Plm(2000,1,5), 4588.096487828742);
    AssertAlmostEqual(&test, Plm(2000,1,10), 5989.67497296503);
    AssertAlmostEqual(&test, Plm(2000,1,50), 9213.368415731344);
    AssertAlmostEqual(&test, Plm(2000,1,100), 10599.81276749922);
    AssertAlmostEqual(&test, Plm(2000,1,500), 13818.736582247746);
    AssertAlmostEqual(&test, Plm(2000,1,1000), 15205.032442995729);
    AssertAlmostEqual(&test, Plm(2000,1,1e+06), 29020.543500834785);
    AssertAlmostEqual(&test, Plm(2000,5,1.01), 316.8970471875355);
    AssertAlmostEqual(&test, Plm(2000,5,1.1), 921.019840981977);
    AssertAlmostEqual(&test, Plm(2000,5,1.5), 1958.5506678457198);
    AssertAlmostEqual(&test, Plm(2000,5,2), 2667.578718520729);
    AssertAlmostEqual(&test, Plm(2000,5,5), 4618.494970156808);
    AssertAlmostEqual(&test, Plm(2000,5,10), 6020.073548814538);
    AssertAlmostEqual(&test, Plm(2000,5,50), 9243.76702061468);
    AssertAlmostEqual(&test, Plm(2000,5,100), 10630.211373283117);
    AssertAlmostEqual(&test, Plm(2000,5,500), 13849.135188319739);
    AssertAlmostEqual(&test, Plm(2000,5,1000), 15235.431049076726);
    AssertAlmostEqual(&test, Plm(2000,5,1e+06), 29050.94210691878);
    AssertAlmostEqual(&test, Plm(2000,10,1.01), 354.7690142801016);
    AssertAlmostEqual(&test, Plm(2000,10,1.1), 958.9805485310268);
    AssertAlmostEqual(&test, Plm(2000,10,1.5), 1996.5312402926402);
    AssertAlmostEqual(&test, Plm(2000,10,2), 2705.5627973939354);
    AssertAlmostEqual(&test, Plm(2000,10,5), 4656.481563761844);
    AssertAlmostEqual(&test, Plm(2000,10,10), 6058.060434674034);
    AssertAlmostEqual(&test, Plm(2000,10,50), 9281.753997204883);
    AssertAlmostEqual(&test, Plm(2000,10,100), 10668.19835268758);
    AssertAlmostEqual(&test, Plm(2000,10,500), 13887.122168624497);
    AssertAlmostEqual(&test, Plm(2000,10,1000), 15273.418029409615);
    AssertAlmostEqual(&test, Plm(2000,10,1e+06), 29088.929087261047);
    AssertAlmostEqual(&test, Plm(2000,50,1.01), 654.5401964183739);
    AssertAlmostEqual(&test, Plm(2000,50,1.1), 1261.5811042164298);
    AssertAlmostEqual(&test, Plm(2000,50,1.5), 2299.767217223022);
    AssertAlmostEqual(&test, Plm(2000,50,2), 3008.9109702192545);
    AssertAlmostEqual(&test, Plm(2000,50,5), 4959.910205706487);
    AssertAlmostEqual(&test, Plm(2000,50,10), 6361.498428723967);
    AssertAlmostEqual(&test, Plm(2000,50,50), 9585.194894635133);
    AssertAlmostEqual(&test, Plm(2000,50,100), 10971.639340174106);
    AssertAlmostEqual(&test, Plm(2000,50,500), 14190.563184920473);
    AssertAlmostEqual(&test, Plm(2000,50,1000), 15576.85904660582);
    AssertAlmostEqual(&test, Plm(2000,50,1e+06), 29392.370104757327);
    AssertAlmostEqual(&test, Plm(2000,100,1.01), 1021.3452165890052);
    AssertAlmostEqual(&test, Plm(2000,100,1.1), 1637.1036366485025);
    AssertAlmostEqual(&test, Plm(2000,100,1.5), 2677.272259784008);
    AssertAlmostEqual(&test, Plm(2000,100,2), 3386.7665032145783);
    AssertAlmostEqual(&test, Plm(2000,100,5), 5338.017175967623);
    AssertAlmostEqual(&test, Plm(2000,100,10), 6739.634623846346);
    AssertAlmostEqual(&test, Plm(2000,100,50), 9963.340162791514);
    AssertAlmostEqual(&test, Plm(2000,100,100), 11349.784889756313);
    AssertAlmostEqual(&test, Plm(2000,100,500), 14568.708824532205);
    AssertAlmostEqual(&test, Plm(2000,100,1000), 15955.004689030764);
    AssertAlmostEqual(&test, Plm(2000,100,1e+06), 29770.515748120008);
    AssertAlmostEqual(&test, Plm(2000,500,1.01), 3691.876731186083);
    AssertAlmostEqual(&test, Plm(2000,500,1.1), 4530.154954240339);
    AssertAlmostEqual(&test, Plm(2000,500,1.5), 5631.436899192581);
    AssertAlmostEqual(&test, Plm(2000,500,2), 6352.051211695172);
    AssertAlmostEqual(&test, Plm(2000,500,5), 8311.325050080186);
    AssertAlmostEqual(&test, Plm(2000,500,10), 9713.877319627418);
    AssertAlmostEqual(&test, Plm(2000,500,50), 12937.87317207842);
    AssertAlmostEqual(&test, Plm(2000,500,100), 14324.326904634738);
    AssertAlmostEqual(&test, Plm(2000,500,500), 17543.253720353125);
    AssertAlmostEqual(&test, Plm(2000,500,1000), 18929.549674874524);
    AssertAlmostEqual(&test, Plm(2000,500,1e+06), 32745.06076397126);
    AssertAlmostEqual(&test, Plm(2000,1000,1.01), 6567.9110381268120446);
    AssertAlmostEqual(&test, Plm(2000,1000,1.1), 7860.963699943079);
    AssertAlmostEqual(&test, Plm(2000,1000,1.5), 9131.423821289158);
    AssertAlmostEqual(&test, Plm(2000,1000,2), 9885.673416917001);
    AssertAlmostEqual(&test, Plm(2000,1000,5), 11869.74194034297);
    AssertAlmostEqual(&test, Plm(2000,1000,10), 13275.210870832698);
    AssertAlmostEqual(&test, Plm(2000,1000,50), 16500.113658459268);
    AssertAlmostEqual(&test, Plm(2000,1000,100), 17886.59553305319);
    AssertAlmostEqual(&test, Plm(2000,1000,500), 21105.531351687878);
    AssertAlmostEqual(&test, Plm(2000,1000,1000), 22491.827587530606);
    AssertAlmostEqual(&test, Plm(2000,1000,1e+06), 36307.33877040076);

    AssertAlmostEqual(&test, Plm(5000,0,1.01), 702.3888512590499);
    AssertAlmostEqual(&test, Plm(5000,0,1.1), 2213.27569287925);
    AssertAlmostEqual(&test, Plm(5000,0,1.5), 4807.3661249465185);
    AssertAlmostEqual(&test, Plm(5000,0,2), 6579.995754239426);
    AssertAlmostEqual(&test, Plm(5000,0,5), 11457.33249056974);
    AssertAlmostEqual(&test, Plm(5000,0,10), 14961.284502089478);
    AssertAlmostEqual(&test, Plm(5000,0,50), 23020.519918402657);
    AssertAlmostEqual(&test, Plm(5000,0,100), 26486.63085401582);
    AssertAlmostEqual(&test, Plm(5000,0,500), 34533.9404088646);
    AssertAlmostEqual(&test, Plm(5000,0,1000), 37999.68006129632);
    AssertAlmostEqual(&test, Plm(5000,0,1e+06), 72538.4577060812);
    AssertAlmostEqual(&test, Plm(5000,1,1.01), 710.9054316145622);
    AssertAlmostEqual(&test, Plm(5000,1,1.1), 2221.792745997359);
    AssertAlmostEqual(&test, Plm(5000,1,1.5), 4815.883283969271);
    AssertAlmostEqual(&test, Plm(5000,1,2), 6588.512931959001);
    AssertAlmostEqual(&test, Plm(5000,1,5), 11465.849681698872);
    AssertAlmostEqual(&test, Plm(5000,1,10), 14969.801694777063);
    AssertAlmostEqual(&test, Plm(5000,1,50), 23029.037111574064);
    AssertAlmostEqual(&test, Plm(5000,1,100), 26495.148047202234);
    AssertAlmostEqual(&test, Plm(5000,1,500), 34542.457602055816);
    AssertAlmostEqual(&test, Plm(5000,1,1000), 38008.197254487684);
    AssertAlmostEqual(&test, Plm(5000,1,1e+06), 72546.97489927262);
    AssertAlmostEqual(&test, Plm(5000,5,1.01), 744.957495786975);
    AssertAlmostEqual(&test, Plm(5000,5,1.1), 2255.8561564051015);
    AssertAlmostEqual(&test, Plm(5000,5,1.5), 4849.9492360868335);
    AssertAlmostEqual(&test, Plm(5000,5,2), 6622.579332800245);
    AssertAlmostEqual(&test, Plm(5000,5,5), 11499.916404369476);
    AssertAlmostEqual(&test, Plm(5000,5,10), 15003.868454850488);
    AssertAlmostEqual(&test, Plm(5000,5,50), 23063.10388325927);
    AssertAlmostEqual(&test, Plm(5000,5,100), 26529.214819247612);
    AssertAlmostEqual(&test, Plm(5000,5,500), 34576.52437421642);
    AssertAlmostEqual(&test, Plm(5000,5,1000), 38042.26402665189);
    AssertAlmostEqual(&test, Plm(5000,5,1e+06), 72581.04167143803);
    AssertAlmostEqual(&test, Plm(5000,10,1.01), 787.490495011102);
    AssertAlmostEqual(&test, Plm(5000,10,1.1), 2298.4246117857556);
    AssertAlmostEqual(&test, Plm(5000,10,1.5), 4892.525634290256);
    AssertAlmostEqual(&test, Plm(5000,10,2), 6665.15713326439);
    AssertAlmostEqual(&test, Plm(5000,10,5), 11542.49521055019);
    AssertAlmostEqual(&test, Plm(5000,10,10), 15046.44737791502);
    AssertAlmostEqual(&test, Plm(5000,10,50), 23105.68284261061);
    AssertAlmostEqual(&test, Plm(5000,10,100), 26571.79377972449);
    AssertAlmostEqual(&test, Plm(5000,10,500), 34619.103335053354);
    AssertAlmostEqual(&test, Plm(5000,10,1000), 38084.84298750007);
    AssertAlmostEqual(&test, Plm(5000,10,1e+06), 72623.62063228997);
    AssertAlmostEqual(&test, Plm(5000,50,1.01), 1126.4713229422691);
    AssertAlmostEqual(&test, Plm(5000,50,1.1), 2638.539374646917);
    AssertAlmostEqual(&test, Plm(5000,50,1.5), 5232.894551146849);
    AssertAlmostEqual(&test, Plm(5000,50,2), 7005.570921840936);
    AssertAlmostEqual(&test, Plm(5000,50,5), 11882.941181909891);
    AssertAlmostEqual(&test, Plm(5000,50,10), 15386.89708955445);
    AssertAlmostEqual(&test, Plm(5000,50,50), 23446.13371542787);
    AssertAlmostEqual(&test, Plm(5000,50,100), 26912.244688558854);
    AssertAlmostEqual(&test, Plm(5000,50,500), 34959.55425540977);
    AssertAlmostEqual(&test, Plm(5000,50,1000), 38425.293908216525);
    AssertAlmostEqual(&test, Plm(5000,50,1e+06), 72964.07155312643);
    AssertAlmostEqual(&test, Plm(5000,100,1.01), 1546.9945606107767);
    AssertAlmostEqual(&test, Plm(5000,100,1.1), 3062.597933636185);
    AssertAlmostEqual(&test, Plm(5000,100,1.5), 5657.747137334137);
    AssertAlmostEqual(&test, Plm(5000,100,2), 7430.563724364048);
    AssertAlmostEqual(&test, Plm(5000,100,5), 12308.034553792588);
    AssertAlmostEqual(&test, Plm(5000,100,10), 15812.002149781383);
    AssertAlmostEqual(&test, Plm(5000,100,50), 23871.24240433362);
    AssertAlmostEqual(&test, Plm(5000,100,100), 27337.35349001806);
    AssertAlmostEqual(&test, Plm(5000,100,500), 35384.66309287539);
    AssertAlmostEqual(&test, Plm(5000,100,1000), 38850.40274680726);
    AssertAlmostEqual(&test, Plm(5000,100,1e+06), 73389.1803920922);
    AssertAlmostEqual(&test, Plm(5000,500,1.01), 4788.217532480271);
    AssertAlmostEqual(&test, Plm(5000,500,1.1), 6411.206340644299);
    AssertAlmostEqual(&test, Plm(5000,500,1.5), 9031.603663817494);
    AssertAlmostEqual(&test, Plm(5000,500,2), 10808.900960793368);
    AssertAlmostEqual(&test, Plm(5000,500,5), 15689.588541138106);
    AssertAlmostEqual(&test, Plm(5000,500,10), 19193.93014021267);
    AssertAlmostEqual(&test, Plm(5000,500,50), 27253.286510978673);
    AssertAlmostEqual(&test, Plm(5000,500,100), 30719.401198371503);
    AssertAlmostEqual(&test, Plm(5000,500,500), 38766.71195343376);
    AssertAlmostEqual(&test, Plm(5000,500,1000), 42232.45164336937);
    AssertAlmostEqual(&test, Plm(5000,500,1e+06), 76771.22930065551);
    AssertAlmostEqual(&test, Plm(5000,1000,1.01), 8575.463660984306);
    AssertAlmostEqual(&test, Plm(5000,1000,1.1), 10485.8028979215);
    AssertAlmostEqual(&test, Plm(5000,1000,1.5), 13183.205188687423);
    AssertAlmostEqual(&test, Plm(5000,1000,2), 14974.427949133653);
    AssertAlmostEqual(&test, Plm(5000,1000,5), 19865.1495998723);
    AssertAlmostEqual(&test, Plm(5000,1000,10), 23370.65965964008);
    AssertAlmostEqual(&test, Plm(5000,1000,50), 31430.37887472157);
    AssertAlmostEqual(&test, Plm(5000,1000,100), 34896.504817425244);
    AssertAlmostEqual(&test, Plm(5000,1000,500), 42943.81917312607);
    AssertAlmostEqual(&test, Plm(5000,1000,1000), 46409.558975573345);
    AssertAlmostEqual(&test, Plm(5000,1000,1e+06), 80948.33667036322);

    AssertAlmostEqual(&test, Plm(10000,0,1.01), 1408.5610609651867);
    AssertAlmostEqual(&test, Plm(10000,0,1.1), 4430.77038620328);
    AssertAlmostEqual(&test, Plm(10000,0,1.5), 9619.137810180902);
    AssertAlmostEqual(&test, Plm(10000,0,2), 13164.438675839137);
    AssertAlmostEqual(&test, Plm(10000,0,5), 22919.14427702755);
    AssertAlmostEqual(&test, Plm(10000,0,10), 29927.05217156812);
    AssertAlmostEqual(&test, Plm(10000,0,50), 46045.52421223366);
    AssertAlmostEqual(&test, Plm(10000,0,100), 52977.74612097734);
    AssertAlmostEqual(&test, Plm(10000,0,500), 69072.36524267748);
    AssertAlmostEqual(&test, Plm(10000,0,1000), 76003.84454791597);
    AssertAlmostEqual(&test, Plm(10000,0,1e+06), 145081.39983761078);
    AssertAlmostEqual(&test, Plm(10000,1,1.01), 1417.771095028489);
    AssertAlmostEqual(&test, Plm(10000,1,1.1), 4439.980656547012);
    AssertAlmostEqual(&test, Plm(10000,1,1.5), 9628.348133469693);
    AssertAlmostEqual(&test, Plm(10000,1,2), 13173.64900847564);
    AssertAlmostEqual(&test, Plm(10000,1,5), 22928.354616368437);
    AssertAlmostEqual(&test, Plm(10000,1,10), 29936.262511688194);
    AssertAlmostEqual(&test, Plm(10000,1,50), 46054.73455259563);
    AssertAlmostEqual(&test, Plm(10000,1,100), 52986.95646134681);
    AssertAlmostEqual(&test, Plm(10000,1,500), 69081.57558304936);
    AssertAlmostEqual(&test, Plm(10000,1,1000), 76013.05488828792);
    AssertAlmostEqual(&test, Plm(10000,1,1e+06), 145090.61017798274);
    AssertAlmostEqual(&test, Plm(10000,5,1.01), 1454.6041049667558);
    AssertAlmostEqual(&test, Plm(10000,5,1.1), 4476.819337207217);
    AssertAlmostEqual(&test, Plm(10000,5,1.5), 9665.188084811127);
    AssertAlmostEqual(&test, Plm(10000,5,2), 13210.489184162148);
    AssertAlmostEqual(&test, Plm(10000,5,5), 22965.194952960173);
    AssertAlmostEqual(&test, Plm(10000,5,10), 29973.10286698038);
    AssertAlmostEqual(&test, Plm(10000,5,50), 46091.57491369342);
    AssertAlmostEqual(&test, Plm(10000,5,100), 53023.796822624674);
    AssertAlmostEqual(&test, Plm(10000,5,500), 69118.41594438482);
    AssertAlmostEqual(&test, Plm(10000,5,1000), 76049.89524962519);
    AssertAlmostEqual(&test, Plm(10000,5,1e+06), 145127.45053932062);
    AssertAlmostEqual(&test, Plm(10000,10,1.01), 1500.6293325333045);
    AssertAlmostEqual(&test, Plm(10000,10,1.1), 4522.862285676423);
    AssertAlmostEqual(&test, Plm(10000,10,1.5), 9711.235004156617);
    AssertAlmostEqual(&test, Plm(10000,10,2), 13256.536804585901);
    AssertAlmostEqual(&test, Plm(10000,10,5), 23011.243076212744);
    AssertAlmostEqual(&test, Plm(10000,10,10), 30019.151048671865);
    AssertAlmostEqual(&test, Plm(10000,10,50), 46137.6231135274);
    AssertAlmostEqual(&test, Plm(10000,10,100), 53069.84502302139);
    AssertAlmostEqual(&test, Plm(10000,10,500), 69164.46414496156);
    AssertAlmostEqual(&test, Plm(10000,10,1000), 76095.94345020756);
    AssertAlmostEqual(&test, Plm(10000,10,1e+06), 145173.49873990484);
    AssertAlmostEqual(&test, Plm(10000,50,1.01), 1868.1896944724529);
    AssertAlmostEqual(&test, Plm(10000,50,1.1), 4890.989633810495);
    AssertAlmostEqual(&test, Plm(10000,50,1.5), 10079.489418291263);
    AssertAlmostEqual(&test, Plm(10000,50,2), 13624.813653147077);
    AssertAlmostEqual(&test, Plm(10000,50,5), 23379.536015277678);
    AssertAlmostEqual(&test, Plm(10000,50,10), 30387.445857781695);
    AssertAlmostEqual(&test, Plm(10000,50,50), 46505.91850319702);
    AssertAlmostEqual(&test, Plm(10000,50,100), 53438.140430698666);
    AssertAlmostEqual(&test, Plm(10000,50,500), 69532.75955839957);
    AssertAlmostEqual(&test, Plm(10000,50,1000), 76464.23886382558);
    AssertAlmostEqual(&test, Plm(10000,50,1e+06), 145541.7941535829);
    AssertAlmostEqual(&test, Plm(10000,100,1.01), 2326.036787794576);
    AssertAlmostEqual(&test, Plm(10000,100,1.1), 5350.607526954631);
    AssertAlmostEqual(&test, Plm(10000,100,1.5), 10539.504367184158);
    AssertAlmostEqual(&test, Plm(10000,100,2), 14084.89870864949);
    AssertAlmostEqual(&test, Plm(10000,100,5), 23839.67135337468);
    AssertAlmostEqual(&test, Plm(10000,100,10), 30847.587039765254);
    AssertAlmostEqual(&test, Plm(10000,100,50), 46966.061499429685);
    AssertAlmostEqual(&test, Plm(10000,100,100), 53898.28348320525);
    AssertAlmostEqual(&test, Plm(10000,100,500), 69992.90262890846);
    AssertAlmostEqual(&test, Plm(10000,100,1000), 76924.381934897);
    AssertAlmostEqual(&test, Plm(10000,100,1e+06), 146001.9372248418);
    AssertAlmostEqual(&test, Plm(10000,500,1.01), 5925.326975199668);
    AssertAlmostEqual(&test, Plm(10000,500,1.1), 9005.767857665567);
    AssertAlmostEqual(&test, Plm(10000,500,1.5), 14207.350158116158);
    AssertAlmostEqual(&test, Plm(10000,500,2), 17754.987132949453);
    AssertAlmostEqual(&test, Plm(10000,500,5), 27511.368637020114);
    AssertAlmostEqual(&test, Plm(10000,500,10), 34519.471324789796);
    AssertAlmostEqual(&test, Plm(10000,500,50), 50638.00384023707);
    AssertAlmostEqual(&test, Plm(10000,500,100), 57570.22762477764);
    AssertAlmostEqual(&test, Plm(10000,500,500), 73664.84734655457);
    AssertAlmostEqual(&test, Plm(10000,500,1000), 80596.32667054408);
    AssertAlmostEqual(&test, Plm(10000,500,1e+06), 149673.8819664892);
    AssertAlmostEqual(&test, Plm(10000,1000,1.01), 10273.400440643047);
    AssertAlmostEqual(&test, Plm(10000,1000,1.1), 13519.734372125722);
    AssertAlmostEqual(&test, Plm(10000,1000,1.5), 18760.708531723078);
    AssertAlmostEqual(&test, Plm(10000,1000,2), 22315.34403779489);
    AssertAlmostEqual(&test, Plm(10000,1000,5), 32076.750933853808);
    AssertAlmostEqual(&test, Plm(10000,1000,10), 39085.437963553515);
    AssertAlmostEqual(&test, Plm(10000,1000,50), 55204.15190096591);
    AssertAlmostEqual(&test, Plm(10000,1000,100), 62136.38131289363);
    AssertAlmostEqual(&test, Plm(10000,1000,500), 78231.0028349007);
    AssertAlmostEqual(&test, Plm(10000,1000,1000), 85162.48221514323);
    AssertAlmostEqual(&test, Plm(10000,1000,1e+06), 154240.03752983926);

    AssertAlmostEqual(&test, Plm(15000,0,1.01), 2114.877154474252);
    AssertAlmostEqual(&test, Plm(15000,0,1.1), 6648.408923905316);
    AssertAlmostEqual(&test, Plm(15000,0,1.5), 14431.053330965888);
    AssertAlmostEqual(&test, Plm(15000,0,2), 19749.025431431186);
    AssertAlmostEqual(&test, Plm(15000,0,5), 34381.09989636012);
    AssertAlmostEqual(&test, Plm(15000,0,10), 44892.963673791644);
    AssertAlmostEqual(&test, Plm(15000,0,50), 69070.67233876922);
    AssertAlmostEqual(&test, Plm(15000,0,100), 79469.00522064215);
    AssertAlmostEqual(&test, Plm(15000,0,500), 103610.93390919326);
    AssertAlmostEqual(&test, Plm(15000,0,1000), 114008.15286723853);
    AssertAlmostEqual(&test, Plm(15000,0,1e+06), 217624.48580184323);
    AssertAlmostEqual(&test, Plm(15000,1,1.01), 2124.492755772817);
    AssertAlmostEqual(&test, Plm(15000,1,1.1), 6658.024682701772);
    AssertAlmostEqual(&test, Plm(15000,1,1.5), 14440.669125057437);
    AssertAlmostEqual(&test, Plm(15000,1,2), 19758.641231754387);
    AssertAlmostEqual(&test, Plm(15000,1,5), 34390.715701152827396);
    AssertAlmostEqual(&test, Plm(15000,1,10), 44902.57947910379);
    AssertAlmostEqual(&test, Plm(15000,1,50), 69080.28814424263);
    AssertAlmostEqual(&test, Plm(15000,1,100), 79478.62102612057);
    AssertAlmostEqual(&test, Plm(15000,1,500), 103620.54971467328);
    AssertAlmostEqual(&test, Plm(15000,1,1000), 114017.7686727186);
    AssertAlmostEqual(&test, Plm(15000,1,1e+06), 217634.1016073233);
    AssertAlmostEqual(&test, Plm(15000,5,1.01), 2162.950410605883);
    AssertAlmostEqual(&test, Plm(15000,5,1.1), 6696.486117481743);
    AssertAlmostEqual(&test, Plm(15000,5,1.5), 14479.13140691958);
    AssertAlmostEqual(&test, Plm(15000,5,2), 19797.103663176185);
    AssertAlmostEqual(&test, Plm(15000,5,5), 34429.178239842679409);
    AssertAlmostEqual(&test, Plm(15000,5,10), 44941.0420302604);
    AssertAlmostEqual(&test, Plm(15000,5,50), 69118.75069926957);
    AssertAlmostEqual(&test, Plm(15000,5,100), 79517.08358126757);
    AssertAlmostEqual(&test, Plm(15000,5,500), 103659.01226985868);
    AssertAlmostEqual(&test, Plm(15000,5,1000), 114056.23122790518);
    AssertAlmostEqual(&test, Plm(15000,5,1e+06), 217672.5641625103);
    AssertAlmostEqual(&test, Plm(15000,10,1.01), 2211.0117905314974);
    AssertAlmostEqual(&test, Plm(15000,10,1.1), 6744.559309710822);
    AssertAlmostEqual(&test, Plm(15000,10,1.5), 14527.207246279691);
    AssertAlmostEqual(&test, Plm(15000,10,2), 19845.179969910194);
    AssertAlmostEqual(&test, Plm(15000,10,5), 34477.254881789341806);
    AssertAlmostEqual(&test, Plm(15000,10,10), 44989.11871116567);
    AssertAlmostEqual(&test, Plm(15000,10,50), 69166.82739226964);
    AssertAlmostEqual(&test, Plm(15000,10,100), 79565.16027464278);
    AssertAlmostEqual(&test, Plm(15000,10,500), 103707.0889633539);
    AssertAlmostEqual(&test, Plm(15000,10,1000), 114104.30792140416);
    AssertAlmostEqual(&test, Plm(15000,10,1e+06), 217720.64085601055);
    AssertAlmostEqual(&test, Plm(15000,50,1.01), 2595.0752444547275);
    AssertAlmostEqual(&test, Plm(15000,50,1.1), 7129.000732855435);
    AssertAlmostEqual(&test, Plm(15000,50,1.5), 14911.733377012852);
    AssertAlmostEqual(&test, Plm(15000,50,2), 20229.721056584967);
    AssertAlmostEqual(&test, Plm(15000,50,5), 34861.806695263626839);
    AssertAlmostEqual(&test, Plm(15000,50,10), 45373.671771315356);
    AssertAlmostEqual(&test, Plm(15000,50,50), 69551.38083945272);
    AssertAlmostEqual(&test, Plm(15000,50,100), 79949.71373383075);
    AssertAlmostEqual(&test, Plm(15000,50,500), 104091.64242638231);
    AssertAlmostEqual(&test, Plm(15000,50,1000), 114488.86138455257);
    AssertAlmostEqual(&test, Plm(15000,50,1e+06), 218105.19431919893);
    AssertAlmostEqual(&test, Plm(15000,100,1.01), 3074.085577879837);
    AssertAlmostEqual(&test, Plm(15000,100,1.1), 7609.191914188202);
    AssertAlmostEqual(&test, Plm(15000,100,1.5), 15392.189262004205);
    AssertAlmostEqual(&test, Plm(15000,100,2), 20710.22367860547);
    AssertAlmostEqual(&test, Plm(15000,100,5), 35342.342838464565222);
    AssertAlmostEqual(&test, Plm(15000,100,10), 45854.21181037582);
    AssertAlmostEqual(&test, Plm(15000,100,50), 70031.92208799243);
    AssertAlmostEqual(&test, Plm(15000,100,100), 80430.25501988578);
    AssertAlmostEqual(&test, Plm(15000,100,500), 104572.18372443867);
    AssertAlmostEqual(&test, Plm(15000,100,1000), 114969.40268298394);
    AssertAlmostEqual(&test, Plm(15000,100,1e+06), 218585.73561775533);
    AssertAlmostEqual(&test, Plm(15000,500,1.01), 6863.584022183291);
    AssertAlmostEqual(&test, Plm(15000,500,1.1), 11436.23685715974);
    AssertAlmostEqual(&test, Plm(15000,500,1.5), 19227.698687936183);
    AssertAlmostEqual(&test, Plm(15000,500,2), 24547.228458838814);
    AssertAlmostEqual(&test, Plm(15000,500,5), 39180.420242044188447);
    AssertAlmostEqual(&test, Plm(15000,500,10), 49692.413880574);
    AssertAlmostEqual(&test, Plm(15000,500,50), 73870.16286147072);
    AssertAlmostEqual(&test, Plm(15000,500,100), 84268.49699385418);
    AssertAlmostEqual(&test, Plm(15000,500,500), 108410.42608244982);
    AssertAlmostEqual(&test, Plm(15000,500,1000), 118807.64505299553);
    AssertAlmostEqual(&test, Plm(15000,500,1e+06), 222423.97799176705);
    AssertAlmostEqual(&test, Plm(15000,1000,1.01), 11496.407465885582);
    AssertAlmostEqual(&test, Plm(15000,1000,1.1), 16183.571356075016);
    AssertAlmostEqual(&test, Plm(15000,1000,1.5), 24001.409783096184);
    AssertAlmostEqual(&test, Plm(15000,1000,2), 29325.609657082314);
    AssertAlmostEqual(&test, Plm(15000,1000,5), 43962.152708235493723);
    AssertAlmostEqual(&test, Plm(15000,1000,10), 54474.535918872665);
    AssertAlmostEqual(&test, Plm(15000,1000,50), 78652.40584682161);
    AssertAlmostEqual(&test, Plm(15000,1000,100), 89050.7437307356);
    AssertAlmostEqual(&test, Plm(15000,1000,500), 113192.67401946476);
    AssertAlmostEqual(&test, Plm(15000,1000,1000), 123589.89302751188);
    AssertAlmostEqual(&test, Plm(15000,1000,1e+06), 227206.2259787838);

    AssertAlmostEqual(&test, Plm(20000,0,1.01), 2821.2521501859833);
    AssertAlmostEqual(&test, Plm(20000,0,1.1), 8866.106353960098);
    AssertAlmostEqual(&test, Plm(20000,0,1.5), 19243.027741897222);
    AssertAlmostEqual(&test, Plm(20000,0,2), 26333.67107678006);
    AssertAlmostEqual(&test, Plm(20000,0,5), 45843.114405170156);
    AssertAlmostEqual(&test, Plm(20000,0,10), 59858.934065460155);
    AssertAlmostEqual(&test, Plm(20000,0,50), 92095.87935473969);
    AssertAlmostEqual(&test, Plm(20000,0,100), 105960.32320974159);
    AssertAlmostEqual(&test, Plm(20000,0,500), 138149.56146514355);
    AssertAlmostEqual(&test, Plm(20000,0,1000), 152012.52007599556);
    AssertAlmostEqual(&test, Plm(20000,0,1e+06), 290167.6306555102);
    AssertAlmostEqual(&test, Plm(20000,1,1.01), 2831.1554846114755);
    AssertAlmostEqual(&test, Plm(20000,1,1.1), 8876.009806500613);
    AssertAlmostEqual(&test, Plm(20000,1,1.5), 19252.93122090845);
    AssertAlmostEqual(&test, Plm(20000,1,2), 26343.57456046497);
    AssertAlmostEqual(&test, Plm(20000,1,5), 45853.017892207162269);
    AssertAlmostEqual(&test, Plm(20000,1,10), 59868.83755288675);
    AssertAlmostEqual(&test, Plm(20000,1,50), 92105.78284228723);
    AssertAlmostEqual(&test, Plm(20000,1,100), 105970.22669729288);
    AssertAlmostEqual(&test, Plm(20000,1,500), 138159.46495269603);
    AssertAlmostEqual(&test, Plm(20000,1,1000), 152022.4235635481);
    AssertAlmostEqual(&test, Plm(20000,1,1e+06), 290177.5341430627);
    AssertAlmostEqual(&test, Plm(20000,5,1.01), 2870.7652597361357);
    AssertAlmostEqual(&test, Plm(20000,5,1.1), 8915.622416384776);
    AssertAlmostEqual(&test, Plm(20000,5,1.5), 19292.544466089745);
    AssertAlmostEqual(&test, Plm(20000,5,2), 26383.187917814612);
    AssertAlmostEqual(&test, Plm(20000,5,5), 45892.631330007051225);
    AssertAlmostEqual(&test, Plm(20000,5,10), 59908.45100003662);
    AssertAlmostEqual(&test, Plm(20000,5,50), 92145.39629233984);
    AssertAlmostEqual(&test, Plm(20000,5,100), 106009.8401474355);
    AssertAlmostEqual(&test, Plm(20000,5,500), 138199.07840286748);
    AssertAlmostEqual(&test, Plm(20000,5,1000), 152062.03701372043);
    AssertAlmostEqual(&test, Plm(20000,5,1e+06), 290217.14759323536);
    AssertAlmostEqual(&test, Plm(20000,10,1.01), 2920.2694626682946);
    AssertAlmostEqual(&test, Plm(20000,10,1.1), 8965.135477927473);
    AssertAlmostEqual(&test, Plm(20000,10,1.5), 19342.05951293565);
    AssertAlmostEqual(&test, Plm(20000,10,2), 26432.70331518658);
    AssertAlmostEqual(&test, Plm(20000,10,5), 45942.146978786053592);
    AssertAlmostEqual(&test, Plm(20000,10,10), 59957.96667803433);
    AssertAlmostEqual(&test, Plm(20000,10,50), 92194.91197940856);
    AssertAlmostEqual(&test, Plm(20000,10,100), 106059.3558347856);
    AssertAlmostEqual(&test, Plm(20000,10,500), 138248.59409030757);
    AssertAlmostEqual(&test, Plm(20000,10,1000), 152111.55270116334);
    AssertAlmostEqual(&test, Plm(20000,10,1e+06), 290266.6632806792);
    AssertAlmostEqual(&test, Plm(20000,50,1.01), 3315.982420753906);
    AssertAlmostEqual(&test, Plm(20000,50,1.1), 9361.13190122151);
    AssertAlmostEqual(&test, Plm(20000,50,1.5), 19738.11946567748);
    AssertAlmostEqual(&test, Plm(20000,50,2), 26828.774484752685);
    AssertAlmostEqual(&test, Plm(20000,50,5), 46338.226193374866492);
    AssertAlmostEqual(&test, Plm(20000,50,10), 60354.046827621736);
    AssertAlmostEqual(&test, Plm(20000,50,50), 92590.99241926857);
    AssertAlmostEqual(&test, Plm(20000,50,100), 106455.43628364921);
    AssertAlmostEqual(&test, Plm(20000,50,500), 138644.67454205148);
    AssertAlmostEqual(&test, Plm(20000,50,1000), 152507.63315299727);
    AssertAlmostEqual(&test, Plm(20000,50,1e+06), 290662.7437325431);
    AssertAlmostEqual(&test, Plm(20000,100,1.01), 3809.8219018540085);
    AssertAlmostEqual(&test, Plm(20000,100,1.1), 9855.857082038);
    AssertAlmostEqual(&test, Plm(20000,100,1.5), 20233.043172830996);
    AssertAlmostEqual(&test, Plm(20000,100,2), 27323.733244360414);
    AssertAlmostEqual(&test, Plm(20000,100,5), 46833.210093649863698);
    AssertAlmostEqual(&test, Plm(20000,100,10), 60849.033649766854);
    AssertAlmostEqual(&test, Plm(20000,100,50), 93085.98014851556);
    AssertAlmostEqual(&test, Plm(20000,100,100), 106950.42404103246);
    AssertAlmostEqual(&test, Plm(20000,100,500), 139139.66230843565);
    AssertAlmostEqual(&test, Plm(20000,100,1000), 153002.62091966267);
    AssertAlmostEqual(&test, Plm(20000,100,1e+06), 291157.73149930226);
    AssertAlmostEqual(&test, Plm(20000,500,1.01), 7728.534542326583);
    AssertAlmostEqual(&test, Plm(20000,500,1.1), 13802.809846881493);
    AssertAlmostEqual(&test, Plm(20000,500,1.5), 24186.34623308241);
    AssertAlmostEqual(&test, Plm(20000,500,2), 31278.157885840057);
    AssertAlmostEqual(&test, Plm(20000,500,5), 50788.439213520166837);
    AssertAlmostEqual(&test, Plm(20000,500,10), 64804.356269107346);
    AssertAlmostEqual(&test, Plm(20000,500,50), 97041.33179509222);
    AssertAlmostEqual(&test, Plm(20000,500,100), 110905.7765879692);
    AssertAlmostEqual(&test, Plm(20000,500,500), 143095.01514340207);
    AssertAlmostEqual(&test, Plm(20000,500,1000), 156957.97376362936);
    AssertAlmostEqual(&test, Plm(20000,500,1e+06), 295113.084346269);
    AssertAlmostEqual(&test, Plm(20000,1000,1.01), 12547.931146023351);
    AssertAlmostEqual(&test, Plm(20000,1000,1.1), 18709.224918917287);
    AssertAlmostEqual(&test, Plm(20000,1000,1.5), 29112.57425851028);
    AssertAlmostEqual(&test, Plm(20000,1000,2), 36207.889637172215);
    AssertAlmostEqual(&test, Plm(20000,1000,5), 55720.684672879849289);
    AssertAlmostEqual(&test, Plm(20000,1000,10), 69736.89390963885);
    AssertAlmostEqual(&test, Plm(20000,1000,50), 101973.96014544224);
    AssertAlmostEqual(&test, Plm(20000,1000,100), 115838.40775194409);
    AssertAlmostEqual(&test, Plm(20000,1000,500), 148027.64720746962);
    AssertAlmostEqual(&test, Plm(20000,1000,1000), 161890.60585582274);
    AssertAlmostEqual(&test, Plm(20000,1000,1e+06), 300045.71644783765);

    AssertAlmostEqual(&test, Plm(25000,0,1.01), 3527.6594194311256);
    AssertAlmostEqual(&test, Plm(25000,0,1.1), 11083.836053609333);
    AssertAlmostEqual(&test, Plm(25000,0,1.5), 24055.034421540523355);
    AssertAlmostEqual(&test, Plm(25000,0,2), 32918.348990685103811);
    AssertAlmostEqual(&test, Plm(25000,0,5), 57305.16118242461);
    AssertAlmostEqual(&test, Plm(25000,0,10), 74824.93672556011);
    AssertAlmostEqual(&test, Plm(25000,0,50), 115121.11863913758);
    AssertAlmostEqual(&test, Plm(25000,0,100), 132451.6734672683);
    AssertAlmostEqual(&test, Plm(25000,0,500), 172688.22128952108);
    AssertAlmostEqual(&test, Plm(25000,0,1000), 190016.91955317985);
    AssertAlmostEqual(&test, Plm(25000,0,1e+06), 362710.8077776044);
    AssertAlmostEqual(&test, Plm(25000,1,1.01), 3537.785928037706);
    AssertAlmostEqual(&test, Plm(25000,1,1.1), 11093.962656703903);
    AssertAlmostEqual(&test, Plm(25000,1,1.5), 24065.161045811372);
    AssertAlmostEqual(&test, Plm(25000,1,2), 32928.475618694865);
    AssertAlmostEqual(&test, Plm(25000,1,5), 57315.287813116039088);
    AssertAlmostEqual(&test, Plm(25000,1,10), 74835.063356563203739);
    AssertAlmostEqual(&test, Plm(25000,1,50), 115131.24527023743);
    AssertAlmostEqual(&test, Plm(25000,1,100), 132461.80009837114);
    AssertAlmostEqual(&test, Plm(25000,1,500), 172698.3479206249);
    AssertAlmostEqual(&test, Plm(25000,1,1000), 190027.04618428368);
    AssertAlmostEqual(&test, Plm(25000,1,1e+06), 362720.9344087082);
    AssertAlmostEqual(&test, Plm(25000,5,1.01), 3578.289112495179);
    AssertAlmostEqual(&test, Plm(25000,5,1.1), 11134.468108872583);
    AssertAlmostEqual(&test, Plm(25000,5,1.5), 24105.667006210795);
    AssertAlmostEqual(&test, Plm(25000,5,2), 32968.981668828295);
    AssertAlmostEqual(&test, Plm(25000,5,5), 57355.793927609287705);
    AssertAlmostEqual(&test, Plm(25000,5,10), 74875.569478536403025);
    AssertAlmostEqual(&test, Plm(25000,5,50), 115171.7513945328);
    AssertAlmostEqual(&test, Plm(25000,5,100), 132502.30622273852);
    AssertAlmostEqual(&test, Plm(25000,5,500), 172738.85404501532);
    AssertAlmostEqual(&test, Plm(25000,5,1000), 190067.55230867484);
    AssertAlmostEqual(&test, Plm(25000,5,1e+06), 362761.4405330996);
    AssertAlmostEqual(&test, Plm(25000,10,1.01), 3628.9116805236495);
    AssertAlmostEqual(&test, Plm(25000,10,1.1), 11185.097763491965);
    AssertAlmostEqual(&test, Plm(25000,10,1.5), 24156.298249051084);
    AssertAlmostEqual(&test, Plm(25000,10,2), 33019.61319208734);
    AssertAlmostEqual(&test, Plm(25000,10,5), 57406.425651992777719);
    AssertAlmostEqual(&test, Plm(25000,10,10), 74926.201226294738852);
    AssertAlmostEqual(&test, Plm(25000,10,50), 115222.38314954791);
    AssertAlmostEqual(&test, Plm(25000,10,100), 132552.93797797873);
    AssertAlmostEqual(&test, Plm(25000,10,500), 172789.48580032753);
    AssertAlmostEqual(&test, Plm(25000,10,1000), 190118.18406398932);
    AssertAlmostEqual(&test, Plm(25000,10,1e+06), 362812.0722884148);
    AssertAlmostEqual(&test, Plm(25000,50,1.01), 4033.635704782131);
    AssertAlmostEqual(&test, Plm(25000,50,1.1), 11590.0485533722);
    AssertAlmostEqual(&test, Plm(25000,50,1.5), 24561.299861869786);
    AssertAlmostEqual(&test, Plm(25000,50,2), 33424.62377830127);
    AssertAlmostEqual(&test, Plm(25000,50,5), 57811.442674187744206);
    AssertAlmostEqual(&test, Plm(25000,50,10), 75331.218996484752225);
    AssertAlmostEqual(&test, Plm(25000,50,50), 115627.40115195484);
    AssertAlmostEqual(&test, Plm(25000,50,100), 132957.9559875885);
    AssertAlmostEqual(&test, Plm(25000,50,500), 173194.50381224154);
    AssertAlmostEqual(&test, Plm(25000,50,1000), 190523.2020759753);
    AssertAlmostEqual(&test, Plm(25000,50,1e+06), 363217.09030042484);
    AssertAlmostEqual(&test, Plm(25000,100,1.01), 4538.899385204932);
    AssertAlmostEqual(&test, Plm(25000,100,1.1), 12096.020810286327);
    AssertAlmostEqual(&test, Plm(25000,100,1.5), 25067.430938834794);
    AssertAlmostEqual(&test, Plm(25000,100,2), 33930.78289706407);
    AssertAlmostEqual(&test, Plm(25000,100,5), 58317.621905376598984);
    AssertAlmostEqual(&test, Plm(25000,100,10), 75837.400565157889283);
    AssertAlmostEqual(&test, Plm(25000,100,50), 116133.58344630583);
    AssertAlmostEqual(&test, Plm(25000,100,100), 133464.1383044484);
    AssertAlmostEqual(&test, Plm(25000,100,500), 173700.68613630213);
    AssertAlmostEqual(&test, Plm(25000,100,1000), 191029.38440026093);
    AssertAlmostEqual(&test, Plm(25000,100,1e+06), 363723.27262478543);
    AssertAlmostEqual(&test, Plm(25000,500,1.01), 8555.38381914431);
    AssertAlmostEqual(&test, Plm(25000,500,1.1), 16135.127153740184);
    AssertAlmostEqual(&test, Plm(25000,500,1.5), 29111.618219267526);
    AssertAlmostEqual(&test, Plm(25000,500,2), 37975.86746520351);
    AssertAlmostEqual(&test, Plm(25000,500,5), 62363.350059393290419);
    AssertAlmostEqual(&test, Plm(25000,500,10), 79883.203518480225180);
    AssertAlmostEqual(&test, Plm(25000,500,50), 120179.40962130751);
    AssertAlmostEqual(&test, Plm(25000,500,100), 137509.96519973455);
    AssertAlmostEqual(&test, Plm(25000,500,500), 177746.51326201088);
    AssertAlmostEqual(&test, Plm(25000,500,1000), 195075.21153316982);
    AssertAlmostEqual(&test, Plm(25000,500,1e+06), 367769.09976009437);
    AssertAlmostEqual(&test, Plm(25000,1000,1.01), 13512.433474967982);
    AssertAlmostEqual(&test, Plm(25000,1000,1.1), 21162.229119757285);
    AssertAlmostEqual(&test, Plm(25000,1000,1.5), 34154.58184544597);
    AssertAlmostEqual(&test, Plm(25000,1000,2), 43021.63449297611);
    AssertAlmostEqual(&test, Plm(25000,1000,5), 67411.128146103064856);
    AssertAlmostEqual(&test, Plm(25000,1000,10), 84931.215350627837451);
    AssertAlmostEqual(&test, Plm(25000,1000,50), 125227.49402105229);
    AssertAlmostEqual(&test, Plm(25000,1000,100), 142558.05185036812);
    AssertAlmostEqual(&test, Plm(25000,1000,500), 182794.60063271498);
    AssertAlmostEqual(&test, Plm(25000,1000,1000), 200123.29892637447);
    AssertAlmostEqual(&test, Plm(25000,1000,1e+06), 372817.18716079916);

    AssertAlmostEqual(&test, Plm(30000,0,1.0001), 420.3237618608935);
    AssertAlmostEqual(&test, Plm(30000,0,1.001),  1337.031564197676);
    AssertAlmostEqual(&test, Plm(30000,0,1.01),   4234.087101809644);
    AssertAlmostEqual(&test, Plm(30000,0,1.1),    13301.58616442274);
    AssertAlmostEqual(&test, Plm(30000,0,1.5),    28867.06151190678);
    AssertAlmostEqual(&test, Plm(30000,0,2),      39503.04731523520);
    AssertAlmostEqual(&test, Plm(30000,0,5),      68767.22837026825);
    AssertAlmostEqual(&test, Plm(30000,0,10),     89790.95979624275);
    AssertAlmostEqual(&test, Plm(30000,0,50),     138146.3783341161);
    AssertAlmostEqual(&test, Plm(30000,0,100),    158943.0441353756);
    AssertAlmostEqual(&test, Plm(30000,0,500),    207226.9015244792);
    AssertAlmostEqual(&test, Plm(30000,0,1000),   228021.3394409447);
    AssertAlmostEqual(&test, Plm(30000,0,1e+06),  435254.0053102792);

    AssertAlmostEqual(&test, Plm(30000,1,1.0001), 430.6315512160975);
    AssertAlmostEqual(&test, Plm(30000,1,1.001),  1347.340160434569);
    AssertAlmostEqual(&test, Plm(30000,1,1.01),   4244.395952391655);
    AssertAlmostEqual(&test, Plm(30000,1,1.1),    13311.89509374250);
    AssertAlmostEqual(&test, Plm(30000,1,1.5),    28877.37045887328);
    AssertAlmostEqual(&test, Plm(30000,1,2),      39513.35626531745);
    AssertAlmostEqual(&test, Plm(30000,1,5),      68777.53732258521);
    AssertAlmostEqual(&test, Plm(30000,1,10),     89801.26874881943);
    AssertAlmostEqual(&test, Plm(30000,1,50),     138156.6872867734);
    AssertAlmostEqual(&test, Plm(30000,1,100),    158953.3530880354);
    AssertAlmostEqual(&test, Plm(30000,1,500),    207237.2104771398);
    AssertAlmostEqual(&test, Plm(30000,1,1000),   228031.6483936054);
    AssertAlmostEqual(&test, Plm(30000,1,1e+06),  435264.3142629398);

    AssertAlmostEqual(&test, Plm(30000,2,1.0001), 440.9369806331230);
    AssertAlmostEqual(&test, Plm(30000,2,1.001),  1357.648010490276);
    AssertAlmostEqual(&test, Plm(30000,2,1.01),   4254.704565482517);
    AssertAlmostEqual(&test, Plm(30000,2,1.1),    13322.20394304662);
    AssertAlmostEqual(&test, Plm(30000,2,1.5),    28887.67936111762);
    AssertAlmostEqual(&test, Plm(30000,2,2),      39523.66517690903);
    AssertAlmostEqual(&test, Plm(30000,2,5),      68787.84624088091);
    AssertAlmostEqual(&test, Plm(30000,2,10),     89811.57766789429);
    AssertAlmostEqual(&test, Plm(30000,2,50),     138166.9962060902);
    AssertAlmostEqual(&test, Plm(30000,2,100),    158963.6620073597);
    AssertAlmostEqual(&test, Plm(30000,2,500),    207247.5193964665);
    AssertAlmostEqual(&test, Plm(30000,2,1000),   228041.9573129321);
    AssertAlmostEqual(&test, Plm(30000,2,1e+06),  435274.6231822666);

    AssertAlmostEqual(&test, Plm(30000,5,1.0001), 471.8391095076489);
    AssertAlmostEqual(&test, Plm(30000,5,1.001),  1388.567083567442);
    AssertAlmostEqual(&test, Plm(30000,5,1.01),   4285.628979797350);
    AssertAlmostEqual(&test, Plm(30000,5,1.1),    13353.13001085396);
    AssertAlmostEqual(&test, Plm(30000,5,1.5),    28918.60579950649);
    AssertAlmostEqual(&test, Plm(30000,5,2),      39554.59168072862);
    AssertAlmostEqual(&test, Plm(30000,5,5),      68818.77279162936);
    AssertAlmostEqual(&test, Plm(30000,5,10),     89842.50422409685);
    AssertAlmostEqual(&test, Plm(30000,5,50),     138197.9227639860);
    AssertAlmostEqual(&test, Plm(30000,5,100),    158994.5885653080);
    AssertAlmostEqual(&test, Plm(30000,5,500),    207278.4459544316);
    AssertAlmostEqual(&test, Plm(30000,5,1000),   228072.8838708978);
    AssertAlmostEqual(&test, Plm(30000,5,1e+06),  435305.5497402324);

    AssertAlmostEqual(&test, Plm(30000,250,1.0001), 2925.764762441505);
    AssertAlmostEqual(&test, Plm(30000,250,1.001),  3891.019466411637);
    AssertAlmostEqual(&test, Plm(30000,250,1.01),   6803.907026103897);
    AssertAlmostEqual(&test, Plm(30000,250,1.1),    15876.32518838675);
    AssertAlmostEqual(&test, Plm(30000,250,1.5),    31442.90340744144);
    AssertAlmostEqual(&test, Plm(30000,250,2),      42079.08394315531);
    AssertAlmostEqual(&test, Plm(30000,250,5),      71343.40466694796);
    AssertAlmostEqual(&test, Plm(30000,250,10),     92367.15232539152);
    AssertAlmostEqual(&test, Plm(30000,250,50),     140722.5759026772);
    AssertAlmostEqual(&test, Plm(30000,250,100),    161519.2418602479);
    AssertAlmostEqual(&test, Plm(30000,250,500),    209803.0992993563);
    AssertAlmostEqual(&test, Plm(30000,250,1000),   230597.5372173843);
    AssertAlmostEqual(&test, Plm(30000,250,1e+06),  437830.2030872396);

    AssertAlmostEqual(&test, Plm(50000,0,1.0001), 702.9085898076468);
    AssertAlmostEqual(&test, Plm(50000,0,1.001),  2231.128789568287);
    AssertAlmostEqual(&test, Plm(50000,0,1.01),   7059.907070168809);
    AssertAlmostEqual(&test, Plm(50000,0,1.1),    22172.69583864568);
    AssertAlmostEqual(&test, Plm(50000,0,1.5),    48115.27910257628);
    AssertAlmostEqual(&test, Plm(50000,0,2),      65841.94984232848);
    AssertAlmostEqual(&test, Plm(50000,0,5),      114615.6063503122);
    AssertAlmostEqual(&test, Plm(50000,0,10),     149655.1613076168);
    AssertAlmostEqual(&test, Plm(50000,0,50),     230247.5263426657);
    AssertAlmostEqual(&test, Plm(50000,0,100),    264908.6360364400);
    AssertAlmostEqual(&test, Plm(50000,0,500),    345381.7316929467);
    AssertAlmostEqual(&test, Plm(50000,0,1000),   380039.1282206393);
    AssertAlmostEqual(&test, Plm(50000,0,1e+06),  725426.9046696133);

    AssertAlmostEqual(&test, Plm(50000,1,1.0001), 713.7276704386010);
    AssertAlmostEqual(&test, Plm(50000,1,1.001),  2241.948354030372);
    AssertAlmostEqual(&test, Plm(50000,1,1.01),   7070.726787208949);
    AssertAlmostEqual(&test, Plm(50000,1,1.1),    22183.51560292579);
    AssertAlmostEqual(&test, Plm(50000,1,1.5),    48126.09887744424);
    AssertAlmostEqual(&test, Plm(50000,1,2),      65852.76961906586);
    AssertAlmostEqual(&test, Plm(50000,1,5),      114626.4261283904);
    AssertAlmostEqual(&test, Plm(50000,1,10),     149665.9810858508);
    AssertAlmostEqual(&test, Plm(50000,1,50),     230258.3461209481);
    AssertAlmostEqual(&test, Plm(50000,1,100),    264919.4558147239);
    AssertAlmostEqual(&test, Plm(50000,1,500),    345392.5514712311);
    AssertAlmostEqual(&test, Plm(50000,1,1000),   380049.9479989237);
    AssertAlmostEqual(&test, Plm(50000,1,1e+06),  725437.7244478978);

    AssertAlmostEqual(&test, Plm(50000,2,1.0001), 724.5453357638629);
    AssertAlmostEqual(&test, Plm(50000,2,1.001),  2252.767470847653);
    AssertAlmostEqual(&test, Plm(50000,2,1.01),   7081.546361760349);
    AssertAlmostEqual(&test, Plm(50000,2,1.1),    22194.33531919709);
    AssertAlmostEqual(&test, Plm(50000,2,1.5),    48136.91862547909);
    AssertAlmostEqual(&test, Plm(50000,2,2),      65863.58937270900);
    AssertAlmostEqual(&test, Plm(50000,2,5),      114637.2458860560);
    AssertAlmostEqual(&test, Plm(50000,2,10),     149676.8008439839);
    AssertAlmostEqual(&test, Plm(50000,2,50),     230269.1658792264);
    AssertAlmostEqual(&test, Plm(50000,2,100),    264930.2755730066);
    AssertAlmostEqual(&test, Plm(50000,2,500),    345403.3712295153);
    AssertAlmostEqual(&test, Plm(50000,2,1000),   380060.7677572079);
    AssertAlmostEqual(&test, Plm(50000,2,1e+06),  725448.5442061820);

    AssertAlmostEqual(&test, Plm(50000,5,1.0001), 756.9898399582800);
    AssertAlmostEqual(&test, Plm(50000,5,1.001),  2285.222135428451);
    AssertAlmostEqual(&test, Plm(50000,5,1.01),   7114.004230478166);
    AssertAlmostEqual(&test, Plm(50000,5,1.1),    22226.79417995414);
    AssertAlmostEqual(&test, Plm(50000,5,1.5),    48169.37770858099);
    AssertAlmostEqual(&test, Plm(50000,5,2),      65896.04849506895);
    AssertAlmostEqual(&test, Plm(50000,5,5),      114669.7050365730);
    AssertAlmostEqual(&test, Plm(50000,5,10),     149709.2599977733);
    AssertAlmostEqual(&test, Plm(50000,5,50),     230301.6250340318);
    AssertAlmostEqual(&test, Plm(50000,5,100),    264962.7347278436);
    AssertAlmostEqual(&test, Plm(50000,5,500),    345435.8303843623);
    AssertAlmostEqual(&test, Plm(50000,5,1000),   380093.2269120552);
    AssertAlmostEqual(&test, Plm(50000,5,1e+06),  725481.0033610294);

    AssertAlmostEqual(&test, Plm(50000,10,1.0001), 811.0357084203008);
    AssertAlmostEqual(&test, Plm(50000,10,1.001),  2339.304290159722);
    AssertAlmostEqual(&test, Plm(50000,10,1.01),   7168.097828529987);
    AssertAlmostEqual(&test, Plm(50000,10,1.1),    22280.89132100240);
    AssertAlmostEqual(&test, Plm(50000,10,1.5),    48223.47564371801);
    AssertAlmostEqual(&test, Plm(50000,10,2),      65950.14657041325);
    AssertAlmostEqual(&test, Plm(50000,10,5),      114723.8032124784);
    AssertAlmostEqual(&test, Plm(50000,10,10),     149763.3581853660);
    AssertAlmostEqual(&test, Plm(50000,10,50),     230355.7232252528);
    AssertAlmostEqual(&test, Plm(50000,10,100),    265016.8329191771);
    AssertAlmostEqual(&test, Plm(50000,10,500),    345489.9285757318);
    AssertAlmostEqual(&test, Plm(50000,10,1000),   380147.3251034259);
    AssertAlmostEqual(&test, Plm(50000,10,1e+06),  725535.1015524004);

    AssertAlmostEqual(&test, Plm(50000,100,1.0001), 1777.822576649976);
    AssertAlmostEqual(&test, Plm(50000,100,1.001),  3310.869700600851);
    AssertAlmostEqual(&test, Plm(50000,100,1.01),   8141.173401578325);
    AssertAlmostEqual(&test, Plm(50000,100,1.1),    23254.43455859806);
    AssertAlmostEqual(&test, Plm(50000,100,1.5),    49197.12370075787);
    AssertAlmostEqual(&test, Plm(50000,100,2),      66923.81313480413);
    AssertAlmostEqual(&test, Plm(50000,100,5),      115697.4830509242);
    AssertAlmostEqual(&test, Plm(50000,100,10),     150737.0395665358);
    AssertAlmostEqual(&test, Plm(50000,100,50),     231329.4050853651);
    AssertAlmostEqual(&test, Plm(50000,100,100),    265990.5147941452);
    AssertAlmostEqual(&test, Plm(50000,100,500),    346463.6104554523);
    AssertAlmostEqual(&test, Plm(50000,100,1000),   381121.0069832949);
    AssertAlmostEqual(&test, Plm(50000,100,1e+06),  726508.7834323190);

    return test_results(&test, stderr);
}
